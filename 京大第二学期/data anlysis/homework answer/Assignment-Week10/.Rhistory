# Load necessary libraries / 载入必要的R包
library(tidyverse)     # for data manipulation and visualization / 用于数据处理和可视化
library(lubridate)     # for working with dates / 处理日期和时间
# Read original dataset / 读取原始数据集
bats_raw <- read_csv("dataset_Mata.et.al.2016.csv", na = "na")
# Load necessary libraries / 载入必要的R包
library(tidyverse)     # for data manipulation and visualization / 用于数据处理和可视化
library(lubridate)     # for working with dates / 处理日期和时间
# Read original dataset / 读取原始数据集
bats_raw <- read_csv("dataset_Mata.et.al.2016.csv", na = "na")
# Clean column names and convert types / 清理列名，转换类型
bats_clean <- bats_raw %>%
rename(
Bat_ID = Sample,
Wingspan = `Wingspan (mm)`,
No_Reads = `No. Reads`,
Date_proper = Date
) %>%
mutate(
Wingspan = as.numeric(Wingspan),               # Convert wingspan to numeric / 转换翼带长度
Date_proper = ymd(Date_proper)                 # Format date / 时间格式化
)
# 加载必要的库 / Load required libraries
library(tidyverse)
library(readxl)
library(lubridate)
# 读取 Excel 数据文件 / Read Excel dataset
bats_raw <- read_excel("dataset_Mata.et.al.2016.xlsx")
# 清洗数据 / Clean column names and convert types
bats_clean <- bats_raw %>%
rename(
Bat_ID = Sample,                          # 重命名 Sample 为 Bat_ID
Wingspan = `Wingspan (mm)`,              # 重命名为 Wingspan
No_Reads = `No. Reads`,                  # 重命名为 No_Reads
Date_proper = Date                       # 重命名为 Date_proper
) %>%
mutate(
Wingspan = as.numeric(Wingspan),         # 将翼展字符转换为数值型
Date_proper = ymd(Date_proper)           # 将日期字符串标准化
)
library(tidyverse)     # for data manipulation and visualization / 用于数据处理和可视化
library(lubridate)     # for working with dates / 处理日期和时间
# Read original dataset / 读取原始数据集
bats_raw <- read_csv("dataset_Mata.et.al.2016.csv", na = "na")
# A. Plot distribution of number of reads / 绘制 No_Reads 分布图
q1_plot <- ggplot(bats_clean, aes(x = No_Reads)) +
geom_histogram(binwidth = 5000, fill = "steelblue", color = "black") +
labs(title = "Distribution of Number of Reads",
x = "Number of Reads", y = "Count")
print(q1_plot)
# A. Plot distribution of number of reads / 绘制 No_Reads 分布图
q1_plot <- ggplot(bats_clean, aes(x = No_Reads)) +
geom_histogram(binwidth = 5000) +
labs(title = "Distribution of Number of Reads",
x = "Number of Reads", y = "Count")
# A. Plot distribution of number of reads / 绘制 No_Reads 分布图
q1_plot <- ggplot(bats_clean, aes(x = No_Reads)) +
geom_histogram(binwidth = 5000) +
labs(title = "Distribution of Number of Reads",
x = "Number of Reads", y = "Count")
print(q1_plot)
# A. Plot distribution of number of reads
q1_plot <- ggplot(bats_clean, aes(x = No_Reads)) + geom_histogram(binwidth = 5000)
print(q1_plot)
View(bats_clean)
# D. Calculate mean and median
mean_reads <- mean(bats_clean$No_Reads, na.rm = TRUE)
median_reads <- median(bats_clean$No_Reads, na.rm = TRUE)
# E. Add vertical lines for mean and median
q1_plot_vlines <- q1_plot +
geom_vline(aes(xintercept = mean_reads), color = "red", linetype = "dashed", size = 1) +
geom_vline(aes(xintercept = median_reads), color = "blue", linetype = "dotted", size = 1) +
annotate("text", x = mean_reads + 10000, y = 20, label = "Mean", color = "red") +
annotate("text", x = median_reads + 10000, y = 25, label = "Median", color = "blue")
print(q1_plot_vlines)
# E. Add vertical lines for mean and median
q1_plot_vlines <- q1_plot +
geom_vline(aes(xintercept = mean_reads),) +
geom_vline(aes(xintercept = median_reads), color = "blue", linetype = "dotted", size = 1) +
annotate("text", x = mean_reads + 10000, y = 20, label = "Mean", color = "red") +
annotate("text", x = median_reads + 10000, y = 25, label = "Median", color = "blue")
print(q1_plot_vlines)
# E. Add vertical lines for mean and median
q1_plot_vlines <- q1_plot +
geom_vline(aes(xintercept = mean_reads)) + geom_vline(aes(xintercept = median_reads)) +
annotate("text", x = mean_reads + 10000, y = 20, label = "Mean") + annotate("text", x = median_reads + 10000, y = 25, label = "Median")
print(q1_plot_vlines)
# E. Add vertical lines for mean and median
q1_plot_vlines <- q1_plot +
geom_vline(aes(xintercept = mean_reads)) + geom_vline(aes(xintercept = median_reads))
print(q1_plot_vlines)
## Question 2:
# Count total reads per species
species_reads <- bats_clean %>% group_by(Species) %>% summarise(total_reads = sum(No_Reads, na.rm = TRUE))
# Calculate probability
species_reads <- species_reads %>% mutate(probability = total_reads / sum(total_reads))
# Step 3: Plot histogram
q2_plot <- ggplot(species_reads, aes(x = probability)) + geom_histogram(bins = 30)
print(q2_plot)
